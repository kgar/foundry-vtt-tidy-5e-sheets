/* -------------------------------------- */
/* Quadrone Styles                        */
/* -------------------------------------- */
.tidy5e-sheet.quadrone {
  [data-tab-contents-for='drakkenheim-contamination-tab'] {
    --dod-color-background-primary: #361163;
    --dod-color-background-transparent: #36116366;
    --dod-color-background-secondary: #57417e;
    --dod-color-background-tertiary: #8879a7;
    --dod-color-background-quaternary: #9f94b5;
    --dod-color-accent: hsl(267, 71%, 35%);
    --dod-color-icon: var(--dod-color-background-secondary);
    --dod-color-icon-hover: var(--dod-color-background-primary);
    
    --dod-color-background-alt: var(--t5e-color-hp-hd-dark);
    --dod-color-background-alt-lighter: var(--t5e-color-hp-hd-medium);
    --dod-color-background-alt-lightest: var(--t5e-color-hp-hd-light);
    --dod-color-icon-alt: rgba(255, 255, 255, .5);

    /* Legacy aliases for compatibility */
    --dod-font-color: var(--dod-color-text);
    --dod-background-color: var(--dod-color-primary);
    --dod-background-color-light: var(--dod-color-secondary);
    --dod-background-color-lighter: var(--dod-color-tertiary);

    .description {
      margin-bottom: var(--t5e-size-8x);
      font-size: var(--font-size-14);
    }

    .contamination-actions {
      gap: var(--t5e-size-2x);
      margin-bottom: var(--t5e-size-6x);
      flex-wrap: wrap;

      > * {
        flex: 1 1 fit-content;
      }
    }

    .contamination-levels {
      gap: 0;
      list-style: none;
      padding: var(--t5e-size-2x) 0 0;
      gap: 0.0625rem;

      .symptom {
        align-items: center;
        background-color: transparent;
        background: linear-gradient(to right, var(--dod-color-background-transparent), transparent);
        border-top: none;
        border-left: none;
        border-right: none;
        border-bottom: 0.0625rem solid var(--dod-color-background-secondary);
        border-image: linear-gradient(to right,  transparent 0%, var(--dod-color-background-secondary) 25%, transparent) 1;
        border-radius: var(--t5e-component-card-radius);
        box-shadow: none;
        display: flex;
        flex-direction: row;
        gap: var(--t5e-size-2x);
        justify-content: flex-start;
        min-height: 3.25rem;
        outline: none;
        padding: var(--t5e-size-2x);
        position: relative;
        text-align: left;
        font-weight: var(--font-weight-default);

        &.level-0.active {
          background: linear-gradient(to right,  var(--dod-color-background-alt-lighter), transparent);

          .level-icon {
            background: var(--dod-color-background-alt);
            i {
              color: var(--dod-color-icon-alt);
            }
          }

          &:hover,
          &:focus-within,
          &:active:not(:disabled) {
            background: linear-gradient(to right,  var(--dod-color-background-alt-lighter), transparent);

            .level-icon {
              background: var(--dod-color-background-alt);
              i {
                color: white;
              }
            }
          }
        }

        &.level-0:not(.active) {
          color: var(--t5e-color-text-lightest);
        }


        .level-icon {
          align-items: center;
          background: var(--dod-color-background-primary);
          border-radius: 100%;
          display: flex;
          height: 2.5rem;
          justify-content: center;
          position: relative;
          width: 2.5rem;

          i {
            color: var(--dod-color-icon);
            font-size: var(--font-size-24);
            font-weight: 700;
          }

          .level-number {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
  
            font: var(--t5e-font-title-medium);
  
            color: var(--t5e-color-text-default);
  
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 0 0 0.3125rem var(--dod-background-color), 0 0 0.125rem var(--dod-background-color);
          }
        }

        &:hover,
        &:focus-within,
        &:active:not(:disabled) { 
          background-color: transparent;
          background: linear-gradient(to right,  var(--dod-color-background-primary), transparent);
          outline: none;
          box-shadow: none;
          border-top:none;
          border-left:none;
          border-right:none;
          border-bottom: 0.0625rem solid var(--dod-color-background-secondary);
          border-image: linear-gradient(to right,  transparent 0%, var(--dod-color-background-secondary) 25%, transparent) 1;

          &.active {
            
            background: linear-gradient(to right,  var(--dod-color-background-tertiary) 0%, var(--dod-color-background-secondary) 25%, transparent);
          }

          .level-icon {
            background-color: var(--dod-color-background-secondary);
            i {
              color: var(--dod-color-icon-hover);
            }
            .level-number {
              opacity: 1;
            }
          }
        }

        &.active {
          background: linear-gradient(to right,  var(--dod-color-background-secondary), transparent);
          font-weight: var(--font-weight-label);
          
          .level-number {
            opacity: 1;
          }
        }

        &:last-child {
          border-bottom: none;
        }
      }
      
    }
  }
}

.tidy5e-sheet.quadrone.theme-light {
  [data-tab-contents-for='drakkenheim-contamination-tab'] {
    --dod-color-background-primary: #361163;
    --dod-color-background-transparent: #36116366;
    --dod-color-background-secondary: #57417e;
    --dod-color-background-tertiary: #8879a7;
    --dod-color-background-quaternary: #a294bd77;
    --dod-color-accent: hsl(266, 21%, 72%);
    --dod-color-icon: var(--dod-color-background-secondary);
    --dod-color-icon-hover: var(--dod-color-background-primary);
    
    --dod-color-background-alt: oklch(from var(--t5e-color-hp-hd-medium) calc(l * 0.75) calc(c * 1.2) h / 0.5);
    --dod-color-background-alt-lighter: var(--t5e-color-palette-red-45);
    --dod-color-background-alt-lightest: var(--t5e-color-palette-red-60);
    --dod-color-icon-alt: rgba(255, 255, 255, .5);

    .contamination-levels {
      .symptom.active {
        background: var(--dod-color-background-secondary);
        color: var(--t5e-color-text-oninverse-default);

        &:hover,
        &:focus-within,
        &:active {
          background: var(--dod-color-background-primary);
        }
      }
      .symptom {
        background: var(--dod-color-background-quaternary);

        .level-number {
          color: var(--t5e-color-text-oninverse-default);
        }

        &:hover,
        &:focus-within,
        &:active {
          background: var(--dod-color-background-tertiary);
        }
      }

      .symptom.level-0 {

        .level-icon {
          background: var(--dod-color-background-tertiary);

          i {
            color: var(--dod-color-background-quaternary);
          }
        }

        &.active {
          color: var(--t5e-color-text-oninverse-default);
          background: var(--dod-color-background-alt-lightest);
          
        }

        &:hover,
        &:focus-within,
        &:active {
          background: var(--dod-color-background-alt-lighter);
          color: var(--t5e-color-text-oninverse-default);

          .level-icon {
            background: var(--dod-color-background-alt-lightest);
            
            i {
              color: var(--dod-color-icon-alt);
            }
          }
        }
      }
    }
  }
}

// Hide the Legacy sheet counter which is being injected in Tidy
.tidy5e-sheet .counter.contamination {
  display: none;
}

/* -------------------------------------- */
/* Classic Styles                         */
/* -------------------------------------- */

.tidy5e-sheet.classic {
  [data-tab-contents-for='drakkenheim-contamination-tab'] {
    .description {
      color: #361163;
      font-family: var(--dnd5e-font-roboto-slab);
      font-size: 1rem;
      font-style: italic;
      padding: 0 0.5rem 0.25rem 0.5rem;
      text-align: left;
    }

    .contamination-table {
      border: 0.0625rem solid #361163;
      box-shadow: 0 0 0.625rem #361163;
      font-family: var(--dnd5e-font-roboto-slab);
      font-size: 0.875rem;

      thead {
        background: linear-gradient(90deg, #361163, #8879a7);
        border: none;
        border-bottom: 0.0625rem solid #361163;

        .symptom {
          padding: 0.5em 1em;
        }
      }

      tbody tr {
        opacity: 0.8;
        transition: opacity 0.2s;

        .symptom {
          font-weight: 700;
          padding: 0.5em;
        }

        &.active {
          background: linear-gradient(
            to right,
            #8879a7,
            var(--dnd5e-color-card)
          );
          opacity: 1;

          .symptom {
            color: #000;
            color: initial;
          }
        }
      }
    }

    .pips {
      display: flex;
      justify-content: space-around;
      gap: 0.3125rem;
      padding: 0.625rem 0.75rem;

      .pip {
        --pip-size: 3.125rem;
        --pip-bg-inactive: #8879a7;
        --pip-bg-active: #361163;
        --pip-bg-to-activate: #6e5e8f;
        --pip-bg-to-deactivate: hsl(267, 71%, 35%);

        border: 0.125rem solid #361163;
        border-radius: 100%;
        box-shadow: 0 0 0.375rem var(--dnd5e-shadow-45);
        display: grid;
        filter: drop-shadow(0 0 0.3125rem #361163);
        font-family: var(--font-awesome);
        font-size: var(--font-size-18);
        font-style: normal;
        font-weight: 700;
        justify-content: center;
        margin: 0;
        opacity: 0.6;
        place-content: center;
        text-align: center;

        i {
          transform: scale(0);
          transition: transform 0.2s;
        }

        i:after {
          color: #fff;
          content: 'Ôùì';
          opacity: 0.5;
        }

        &.active i,
        &:hover i,
        &:not(.active):has(~ .pip:hover) i {
          transform: scale(1);
        }

        &.active {
          opacity: 1;

          i:after {
            opacity: 1;
          }
        }
      }
    }
  }
}

.tidy5e-sheet.classic.theme-dark {
  [data-tab-contents-for='drakkenheim-contamination-tab'] {
    .description {
      color: var(--color-text-light-highlight);
    }
  }
}

// Hide the Legacy sheet counter which is being injected in Tidy
.tidy5e-sheet .counter.contamination {
  display: none;
}
